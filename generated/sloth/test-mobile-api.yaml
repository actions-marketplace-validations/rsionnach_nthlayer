version: prometheus/v1
service: test-mobile-api
labels:
  tier: critical
  team: mobile
  type: api
slos:
- name: availability
  objective: 99.95
  description: 99.95% availability
  sli:
    events:
      error_query: sum(rate(http_requests_total{service="test-mobile-api",code=~"5.."}[5m]))
      total_query: sum(rate(http_requests_total{service="test-mobile-api"}[5m]))
  alerting:
    name: TestMobileApiAvailability
    labels:
      tier: critical
      service: test-mobile-api
    annotations:
      summary: SLO availability for test-mobile-api
    ticket_alert:
      labels:
        severity: warning
      annotations:
        summary: Error budget burn on test-mobile-api
    page_alert:
      labels:
        severity: critical
      annotations:
        summary: High error budget burn on test-mobile-api
- name: latency-p99
  objective: 99.0
  description: 99.0% latency p99
  sli:
    events:
      error_query: "histogram_quantile(0.99,\n  rate(http_request_duration_seconds_bucket{service=\"\
        test-mobile-api\"}[5m])\n)\n > 2.0"
      total_query: "sum(rate(0.99,\n  rate(http_request_duration_seconds_bucket{service=\"\
        test-mobile-api\"}[5m])\n)\n)"
  alerting:
    name: TestMobileApiLatencyP99
    labels:
      tier: critical
      service: test-mobile-api
    annotations:
      summary: SLO latency-p99 for test-mobile-api
    ticket_alert:
      labels:
        severity: warning
      annotations:
        summary: Error budget burn on test-mobile-api
    page_alert:
      labels:
        severity: critical
      annotations:
        summary: High error budget burn on test-mobile-api
