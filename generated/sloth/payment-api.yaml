version: prometheus/v1
service: payment-api
labels:
  tier: critical
  team: payments
  type: api
slos:
- name: availability
  objective: 99.95
  description: 99.95% availability
  sli:
    events:
      error_query: sum(rate(http_requests{service="payment-api",code=~"5.."}[5m]))
      total_query: sum(rate(http_requests{service="payment-api"}[5m]))
  alerting:
    name: PaymentApiAvailability
    labels:
      tier: critical
      service: payment-api
    annotations:
      summary: SLO availability for payment-api
    ticket_alert:
      labels:
        severity: warning
      annotations:
        summary: Error budget burn on payment-api
    page_alert:
      labels:
        severity: critical
      annotations:
        summary: High error budget burn on payment-api
- name: latency-p95
  objective: 99.0
  description: 99.0% latency p95
  sli:
    events:
      error_query: "histogram_quantile(0.95,\n  rate(http_request_duration_seconds_bucket{service=\"\
        payment-api\"}[5m])\n)\n > 0.5"
      total_query: "sum(rate(0.95,\n  rate(http_request_duration_seconds_bucket{service=\"\
        payment-api\"}[5m])\n)\n)"
  alerting:
    name: PaymentApiLatencyP95
    labels:
      tier: critical
      service: payment-api
    annotations:
      summary: SLO latency-p95 for payment-api
    ticket_alert:
      labels:
        severity: warning
      annotations:
        summary: Error budget burn on payment-api
    page_alert:
      labels:
        severity: critical
      annotations:
        summary: High error budget burn on payment-api
- name: latency-p99
  objective: 95.0
  description: 95.0% latency p99
  sli:
    events:
      error_query: ' > 1.0'
      total_query: )
  alerting:
    name: PaymentApiLatencyP99
    labels:
      tier: critical
      service: payment-api
    annotations:
      summary: SLO latency-p99 for payment-api
    ticket_alert:
      labels:
        severity: warning
      annotations:
        summary: Error budget burn on payment-api
    page_alert:
      labels:
        severity: critical
      annotations:
        summary: High error budget burn on payment-api
